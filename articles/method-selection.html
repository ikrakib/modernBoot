<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Method Selection and Practical Examples • modernBoot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Method Selection and Practical Examples">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">modernBoot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/method-selection.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><h6 class="dropdown-header" data-toc-skip>Vignettes</h6></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/ikrakib/modernBoot" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Method Selection and Practical Examples</h1>
                        <h4 data-toc-skip class="author">Ibrahim Kholil
Rakib</h4>
            
            <h4 data-toc-skip class="date">2025-12-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ikrakib/modernBoot/blob/main/vignettes/method-selection.Rmd"><code>vignettes/method-selection.Rmd</code></a></small>
      <div class="d-none name"><code>method-selection.Rmd</code></div>
    </div>

    
    
<p>{r setup, include = FALSE} knitr::opts_chunk$set( collapse = TRUE,
comment = “#&gt;”, fig.width = 7, fig.height = 5, eval = TRUE )
library(modernBoot) set.seed(42)</p>
<div class="section level2">
<h2 id="introduction-to-modernboot">Introduction to modernBoot<a class="anchor" aria-label="anchor" href="#introduction-to-modernboot"></a>
</h2>
<p>The <strong>modernBoot</strong> package provides modern resampling
methods for statistical inference beyond standard parametric
assumptions. This vignette demonstrates:</p>
<ul>
<li>How to select the appropriate resampling method for your data</li>
<li>Practical examples for each main function</li>
<li>Guidelines for interpreting results</li>
<li>Best practices for publication-quality analyses</li>
</ul>
<div class="section level3">
<h3 id="when-to-use-each-method">When to Use Each Method<a class="anchor" aria-label="anchor" href="#when-to-use-each-method"></a>
</h3>
<div class="section level4">
<h4 id="nonparametric-bootstrap-iid-data">Nonparametric Bootstrap (IID data)<a class="anchor" aria-label="anchor" href="#nonparametric-bootstrap-iid-data"></a>
</h4>
<p>Use <strong><code><a href="../reference/bs_mean.html">bs_mean()</a></code></strong> or
<strong><code><a href="../reference/bca_ci.html">bca_ci()</a></code></strong> when: - Your data are independent
and identically distributed (IID) - Sample size is moderate to large (n
≥ 30) - You want confidence intervals for the mean</p>
<p><strong>Example: Bootstrap CI for mean height</strong> {r
bootstrap-example} # Simulate height measurements (in cm) heights &lt;-
c(172, 168, 175, 170, 180, 165, 178, 172, 169, 176)</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="percentile-bootstrap-ci">Percentile bootstrap CI<a class="anchor" aria-label="anchor" href="#percentile-bootstrap-ci"></a>
</h2>
<p>result_bs &lt;- bs_mean(heights, R = 1000, conf = 0.95) cat(“Sample
mean:”, round(result_bs<span class="math inline">$stat, 2), "\n")
cat("95% CI:", round(result_bs$</span>ci, 2), “to”, round(result_bs$ci,
2), “”)</p>
</div>
<div class="section level2">
<h2 id="bca-bootstrap-bias-corrected">BCa bootstrap (bias-corrected)<a class="anchor" aria-label="anchor" href="#bca-bootstrap-bias-corrected"></a>
</h2>
<p>result_bca &lt;- bca_ci(heights, R = 1000, conf = 0.95) cat(“BCa CI
lower bound:”, round(result_bca<span class="math inline">$ci, 2), "\n")
cat("BCa CI upper bound:", round(result_bca$</span>ci, 2), “”)</p>
<p><strong>Key difference:</strong> BCa is more accurate for skewed
distributions.</p>
<hr>
<div class="section level4">
<h4 id="time-series-bootstrap">Time Series Bootstrap<a class="anchor" aria-label="anchor" href="#time-series-bootstrap"></a>
</h4>
<p>Use <strong><code><a href="../reference/moving_block_boot.html">moving_block_boot()</a></code></strong> or
<strong><code><a href="../reference/stationary_boot.html">stationary_boot()</a></code></strong> when: - Your data have
temporal dependence (autocorrelation) - Standard IID bootstrap would be
invalid - Examples: stock prices, climate data, economic time series</p>
<p><strong>Example: Moving block bootstrap for AR(1) process</strong> {r
timeseries-example} # Generate AR(1) time series ts_data &lt;-
arima.sim(n = 100, list(ar = 0.7), sd = 1)</p>
</div>
</div>
<div class="section level2">
<h2 id="moving-block-bootstrap-block-size-10">Moving block bootstrap (block size = 10)<a class="anchor" aria-label="anchor" href="#moving-block-bootstrap-block-size-10"></a>
</h2>
<p>boot_samples &lt;- moving_block_boot(ts_data, block_size = 10, R =
200)</p>
</div>
<div class="section level2">
<h2 id="compute-bootstrap-estimate-of-mean">Compute bootstrap estimate of mean<a class="anchor" aria-label="anchor" href="#compute-bootstrap-estimate-of-mean"></a>
</h2>
<p>bootstrap_means &lt;- sapply(boot_samples, mean)</p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>cat(“Original mean:”, round(mean(ts_data), 3), “”) cat(“Bootstrap
mean (average):”, round(mean(bootstrap_means), 3), “”) cat(“Bootstrap
SE:”, round(sd(bootstrap_means), 3), “”)</p>
<p><strong>Choosing block size:</strong> Use
<code>block_size ≈ √n</code> as a rule of thumb.</p>
<hr>
<div class="section level4">
<h4 id="wild-bootstrap-for-regression">Wild Bootstrap for Regression<a class="anchor" aria-label="anchor" href="#wild-bootstrap-for-regression"></a>
</h4>
<p>Use <strong><code><a href="../reference/wild_boot_lm.html">wild_boot_lm()</a></code></strong> when: - You’re
fitting linear regression with <strong>heteroscedasticity</strong> -
Residuals have non-constant variance - You want robust inference for
coefficients</p>
<p><strong>Example: Wild bootstrap for heteroscedastic
regression</strong> {r wild-boot-example} # Generate heteroscedastic
data set.seed(42) x &lt;- seq(-2, 2, length = 50) y &lt;- 2 + 1.5 * x +
rnorm(50, sd = abs(x) * 0.5) # Variance depends on x</p>
</div>
</div>
<div class="section level2">
<h2 id="fit-model">Fit model<a class="anchor" aria-label="anchor" href="#fit-model"></a>
</h2>
<p>fit &lt;- lm(y ~ x)</p>
</div>
<div class="section level2">
<h2 id="wild-bootstrap-with-rademacher-weights">Wild bootstrap with Rademacher weights<a class="anchor" aria-label="anchor" href="#wild-bootstrap-with-rademacher-weights"></a>
</h2>
<p>wb_result &lt;- wild_boot_lm(fit, R = 1000, type = “rademacher”)</p>
<p>cat(“Intercept estimate:”, round(wb_result<span class="math inline">$coef, 3), "\n")
cat("Slope estimate:", round(wb_result$</span>coef, 3), “”)</p>
</div>
<div class="section level2">
<h2 id="bootstrap-confidence-intervals-for-slope">Bootstrap confidence intervals for slope<a class="anchor" aria-label="anchor" href="#bootstrap-confidence-intervals-for-slope"></a>
</h2>
<p>ci_slope &lt;- quantile(wb_result$boot[2, ], probs = c(0.025, 0.975))
cat(“95% CI for slope:”, round(ci_slope, 3), “to”, round(ci_slope, 3),
“”)</p>
<p><strong>Weight schemes:</strong> - <strong>Rademacher</strong>: ±1
with equal probability (faster, robust) - <strong>Mammen</strong>:
Empirically calibrated distribution (asymptotically optimal)</p>
<hr>
<div class="section level4">
<h4 id="permutation-tests">Permutation Tests<a class="anchor" aria-label="anchor" href="#permutation-tests"></a>
</h4>
<p>Use <strong><code><a href="../reference/perm_test_2sample.html">perm_test_2sample()</a></code></strong> when: -
Comparing two independent groups - Avoiding parametric assumptions -
Data are small or non-normal</p>
<p><strong>Example: Two-sample permutation test</strong> {r
perm-test-example} # Group A: untreated group_a &lt;- c(2.3, 4.1, 3.7,
2.9, 4.5, 3.2)</p>
</div>
</div>
<div class="section level2">
<h2 id="group-b-treated-appears-higher">Group B: treated (appears higher)<a class="anchor" aria-label="anchor" href="#group-b-treated-appears-higher"></a>
</h2>
<p>group_b &lt;- c(5.1, 6.2, 4.8, 5.9, 6.7, 5.3)</p>
</div>
<div class="section level2">
<h2 id="permutation-test">Permutation test<a class="anchor" aria-label="anchor" href="#permutation-test"></a>
</h2>
<p>perm_result &lt;- perm_test_2sample(group_a, group_b, R = 5000)</p>
<p>cat(“Mean Group A:”, round(mean(group_a), 2), “”) cat(“Mean Group
B:”, round(mean(group_b), 2), “”) cat(“Difference:”,
round(perm_result<span class="math inline">$obs, 2), "\n")
cat("Two-sided p-value:", round(perm_result$</span>p.value, 4), “”)</p>
<p><strong>Interpretation:</strong> If p-value &lt; 0.05, evidence of
significant group difference.</p>
<hr>
<div class="section level4">
<h4 id="multiple-testing-with-maxt">Multiple Testing with maxT<a class="anchor" aria-label="anchor" href="#multiple-testing-with-maxt"></a>
</h4>
<p>Use <strong><code><a href="../reference/perm_maxT.html">perm_maxT()</a></code></strong> when: - Testing
multiple variables/features simultaneously - Need to control family-wise
error rate (FWER) - Examples: genomics, fMRI, survey data</p>
<p><strong>Example: Permutation maxT for multiple testing</strong> {r
perm-maxT-example} # Simulate gene expression data: 30 genes, 2 groups
set.seed(42) data &lt;- matrix(rnorm(600), nrow = 50, ncol = 12) # 50
obs, 12 variables groups &lt;- rep(0:1, each = 25)</p>
</div>
</div>
<div class="section level2">
<h2 id="introduce-true-signal-in-variable-3">Introduce true signal in variable 3<a class="anchor" aria-label="anchor" href="#introduce-true-signal-in-variable-3"></a>
</h2>
<p>data[1:25, 3] &lt;- data[1:25, 3] + 1.5 # Group effect</p>
</div>
<div class="section level2">
<h2 id="permutation-maxt">Permutation maxT<a class="anchor" aria-label="anchor" href="#permutation-maxt"></a>
</h2>
<p>maxT_result &lt;- perm_maxT(data, groups, R = 1000)</p>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>cat(“Number of variables:”, length(maxT_result<span class="math inline">$p.values), "\n")
cat("FWER-adjusted p-values (first 5):\n")
print(round(maxT_result$</span>p.values[1:5], 4)) cat(“Variable 3
p-value:”, round(maxT_result$p.values, 4), “”)</p>
<p><strong>Key advantage:</strong> Maintains FWER control while being
more powerful than Bonferroni.</p>
<hr>
<div class="section level3">
<h3 id="automatic-method-selection">Automatic Method Selection<a class="anchor" aria-label="anchor" href="#automatic-method-selection"></a>
</h3>
<p>Use <strong><code><a href="../reference/auto_select_method.html">auto_select_method()</a></code></strong> to get
recommendations:</p>
<p>{r auto-select} # Example 1: IID data x_iid &lt;- rnorm(50) rec1
&lt;- auto_select_method(x_iid) cat(“IID data recommendation:”,
rec1$method, “”)</p>
</div>
</div>
<div class="section level2">
<h2 id="example-2-time-series">Example 2: Time series<a class="anchor" aria-label="anchor" href="#example-2-time-series"></a>
</h2>
<p>ts &lt;- arima.sim(n = 100, list(ar = 0.8)) rec2 &lt;-
auto_select_method(ts) cat(“Time series recommendation:”, rec2$method,
“”)</p>
</div>
<div class="section level2">
<h2 id="example-3-multivariate-data">Example 3: Multivariate data<a class="anchor" aria-label="anchor" href="#example-3-multivariate-data"></a>
</h2>
<p>mat &lt;- matrix(rnorm(300), nrow = 50, ncol = 6) rec3 &lt;-
auto_select_method(mat) cat(“Multivariate recommendation:”, rec3$method,
“”)</p>
<hr>
<div class="section level3">
<h3 id="advanced-studentized-ci-for-quantiles">Advanced: Studentized CI for Quantiles<a class="anchor" aria-label="anchor" href="#advanced-studentized-ci-for-quantiles"></a>
</h3>
<p>For extreme quantiles or skewed distributions, use
<strong><code><a href="../reference/studentized_ci.html">studentized_ci()</a></code></strong>:</p>
<p>{r studentized-example} # Right-skewed data (exponential) data_skewed
&lt;- rexp(100, rate = 0.5)</p>
</div>
</div>
<div class="section level2">
<h2 id="standard-median-ci-quantile-based">Standard median CI (quantile-based)<a class="anchor" aria-label="anchor" href="#standard-median-ci-quantile-based"></a>
</h2>
</div>
<div class="section level2">
<h2 id="vs--studentized-ci-more-accurate-for-skewed-data">vs. Studentized CI (more accurate for skewed data)<a class="anchor" aria-label="anchor" href="#vs--studentized-ci-more-accurate-for-skewed-data"></a>
</h2>
<p>ci_studentized &lt;- studentized_ci(data_skewed, q = 0.5, R = 500,
Rinner = 100)</p>
<p>cat(“Studentized 95% CI for median:”) cat(“Lower:”,
round(ci_studentized, 2), “”) cat(“Upper:”, round(ci_studentized, 2),
“”)</p>
<hr>
<div class="section level3">
<h3 id="simulation-study-example">Simulation Study Example<a class="anchor" aria-label="anchor" href="#simulation-study-example"></a>
</h3>
<p>Compare bootstrap methods on data from a known distribution:</p>
<p>{r sim-example, eval = FALSE} # Define data generator generator &lt;-
function() { # Sample from mixture of two normals (bimodal) component
&lt;- sample(1:2, size = 50, replace = TRUE, prob = c(0.6, 0.4))
ifelse(component == 1, rnorm(50, mean = -2, sd = 1), rnorm(50, mean = 3,
sd = 1) ) }</p>
</div>
</div>
<div class="section level2">
<h2 id="run-comparison">Run comparison<a class="anchor" aria-label="anchor" href="#run-comparison"></a>
</h2>
<p>sim_results &lt;- compare_methods_sim( data_generator = generator,
Rsim = 50, # 50 simulated datasets Rboot = 1000, # 1000 bootstrap
replicates each parallel = TRUE # Use parallelization )</p>
</div>
<div class="section level2">
<h2 id="analyze-coverage">Analyze coverage<a class="anchor" aria-label="anchor" href="#analyze-coverage"></a>
</h2>
<p>coverage_bs &lt;- mean(sapply(sim_results, function(res) { if
(is.list(res<span class="math inline">$bs)) {
    # Check if true mean (-2 to 3 range) is in CI
    res$</span>bs<span class="math inline">$ci &lt;= 0.5 &amp;&amp; 0.5
&lt;= res$</span>bs$ci } else { FALSE } }))</p>
<p>cat(“Bootstrap coverage:”, round(coverage_bs, 3), “”)</p>
<hr>
<div class="section level3">
<h3 id="best-practices-for-publication">Best Practices for Publication<a class="anchor" aria-label="anchor" href="#best-practices-for-publication"></a>
</h3>
<div class="section level4">
<h4 id="report-both-point-estimate-and-ci">1. <strong>Report Both Point Estimate and CI</strong><a class="anchor" aria-label="anchor" href="#report-both-point-estimate-and-ci"></a>
</h4>
<p>{r} result &lt;- bs_mean(rnorm(50), R = 5000) # Report: Mean = X (95%
CI: [A, B])</p>
</div>
<div class="section level4">
<h4 id="check-assumptions">2. <strong>Check Assumptions</strong><a class="anchor" aria-label="anchor" href="#check-assumptions"></a>
</h4>
<ul>
<li>Plot your data before choosing a method</li>
<li>For time series, examine ACF plots</li>
<li>For regression, check residual plots for heteroscedasticity</li>
</ul>
</div>
<div class="section level4">
<h4 id="use-sufficient-bootstrap-replicates">3. <strong>Use Sufficient Bootstrap Replicates</strong><a class="anchor" aria-label="anchor" href="#use-sufficient-bootstrap-replicates"></a>
</h4>
<ul>
<li>
<strong>R = 2000</strong> for quick exploratory analysis</li>
<li>
<strong>R = 5000</strong> for publication-quality results</li>
<li>
<strong>R = 10000</strong> for extremely skewed distributions</li>
</ul>
</div>
<div class="section level4">
<h4 id="document-your-choice">4. <strong>Document Your Choice</strong><a class="anchor" aria-label="anchor" href="#document-your-choice"></a>
</h4>
<p>In your methods section: &gt; “We computed 95% confidence intervals
using the moving block bootstrap with block size = 15 to account for
temporal autocorrelation in the time series.”</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="parallelization-for-speed">Parallelization for Speed<a class="anchor" aria-label="anchor" href="#parallelization-for-speed"></a>
</h3>
<p>By default, <code>modernBoot</code> functions use sequential
computation. For faster results on large datasets:</p>
<p>{r, eval = FALSE} library(future)</p>
</div>
</div>
<div class="section level2">
<h2 id="enable-parallel-processing">Enable parallel processing<a class="anchor" aria-label="anchor" href="#enable-parallel-processing"></a>
</h2>
<p>plan(multisession, workers = 4)</p>
</div>
<div class="section level2">
<h2 id="now-bootstrappermutation-calls-use-4-cores">Now bootstrap/permutation calls use 4 cores<a class="anchor" aria-label="anchor" href="#now-bootstrappermutation-calls-use-4-cores"></a>
</h2>
<p>result &lt;- bs_mean(large_data, R = 10000)</p>
</div>
<div class="section level2">
<h2 id="revert-to-sequential">Revert to sequential<a class="anchor" aria-label="anchor" href="#revert-to-sequential"></a>
</h2>
<p>plan(sequential)</p>
<hr>
<div class="section level3">
<h3 id="common-pitfalls-to-avoid">Common Pitfalls to Avoid<a class="anchor" aria-label="anchor" href="#common-pitfalls-to-avoid"></a>
</h3>
<p>❌ <strong>Using standard bootstrap on dependent data</strong> → Use
block or stationary bootstrap</p>
<p>❌ <strong>Ignoring heteroscedasticity in regression</strong> → Use
wild bootstrap</p>
<p>❌ <strong>R too small</strong> → CI may be unstable, use R ≥
2000</p>
<p>❌ <strong>Multiple testing without correction</strong> → Use
permutation maxT</p>
<p>✅ <strong>Do use <code><a href="../reference/auto_select_method.html">auto_select_method()</a></code> if
unsure</strong> → It helps guide your choice</p>
<hr>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ul>
<li>Efron, B., &amp; Tibshirani, R. J. (1993). <em>An introduction to
the bootstrap</em>. Chapman and Hall/CRC.</li>
<li>Politis, D. N., &amp; Romano, J. P. (1994). The stationary
bootstrap. <em>Journal of the American Statistical Association</em>,
89(428), 1303-1313.</li>
<li>Wu, C. F. (1986). Jackknife, bootstrap and other resampling methods
in regression analysis. <em>Annals of Statistics</em>, 14(4),
1261-1295.</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h3>
<p>{r, eval = FALSE} # See all functions ?modernBoot</p>
</div>
</div>
<div class="section level2">
<h2 id="get-help-on-specific-function">Get help on specific function<a class="anchor" aria-label="anchor" href="#get-help-on-specific-function"></a>
</h2>
<p>?bs_mean ?wild_boot_lm ?perm_test_2sample</p>
</div>
<div class="section level2">
<h2 id="view-this-vignette">View this vignette<a class="anchor" aria-label="anchor" href="#view-this-vignette"></a>
</h2>
<p>vignette(“method-selection”)</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ibrahim Kholil Rakib.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
